<%- include("./partials/header.ejs") %>
    <div class="container">
        <div class="acc-content">
            <img src="data:image/png;base64,<%=image%>" alt="user avatar" />
            <h1 class="light-text user-name">
                <%= username %>
            </h1>

            <a class="edit" href="/settings/profile">Edit profile</a>

            <button class="copy" id="copy-url-btn">copy link</button>

        </div>

        <!--if there are NO Messages to the user-->
        <% if(!messages.length) { %>

            <div>
                <h2>Your Messages</h2>
                <p> messages Yet, share your link with your friends</p>
            </div>

            <!--if there are messages to the user-->
            <%}else{%>
                <!--messages-->
                <div class="messages-container background-light light-text">
                    <p class="heading" onclick="showMsgs()">Your Messages &nbsp;<i class="fas fa-angle-down"></i></p>

                    <div class="inner">

                        <!--loop through the messages array-->
                        <% messages.forEach(messageObj=>{ %>

                            <!--message container-->
                            <div class="message-container background-light">

                                <!--message content-->
                                <div class="message">
                                    <div class="message-content">
                                        <!--check if the message is public-->
                                        <% if(messageObj.isPublic){ %>
                                            <!--add globe icon before the public message-->
                                            <i class="fas fa-globe-americas"></i>
                                            <%}%>
                                                <%=messageObj.message%>
                                    </div>
                                    <!--message date-->
                                    <div class="message-date">
                                        <%=messageObj.date%>
                                    </div>
                                </div>
                            </div>
                            <%})%>
                                <%}%>

                    </div>
                </div>
    </div>
    <%- include("./partials/footer.ejs") %>
        <script src="../js/messagesContainer.js"></script>

        <script type="text/javascript">
            //select copy button url
            let urlBtn = document.getElementById("copy-url-btn")

            //create input tag to copy the user link from it
            const pseudoInput = document.createElement("input")
            pseudoInput.value = window.location.href //assign the user url to the input value

            urlBtn.onclick = () => {
                //append the pseudo input tag to the body
                document.getElementsByTagName("body")[0].appendChild(pseudoInput)
                pseudoInput.select() //select the input value (user url)
                document.execCommand("copy") //copy the input value (user url)

                //remove the pseudo input tag from the body
                document.getElementsByTagName("body")[0].removeChild(pseudoInput)
                urlBtn.innerText = "link Copied !"

            }
        </script>

        </html>